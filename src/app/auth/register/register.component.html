<section class="register-page">
  <span class="background-glow background-glow--right" aria-hidden="true"></span>
  <span class="background-glow background-glow--left" aria-hidden="true"></span>

  <nav class="register-nav">
    <div class="logo">
      <span class="logo__badge" aria-hidden="true">
        <svg viewBox="0 0 24 24" stroke-width="2.5" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
      </span>
      <span class="logo__text">Vigía.AI</span>
    </div>
  </nav>

  <div class="register-card">
    <div class="glass-card">
      <header class="card-header">
        <h1>Crear Cuenta</h1>
        <p>Únete a la nueva era de la seguridad en obra.</p>
      </header>

      <form class="register-form" [formGroup]="registerForm" (ngSubmit)="onSubmit()" novalidate>
        <div class="form-grid">
          <div class="form-field" [class.form-field--invalid]="firstNameControl?.invalid && firstNameControl?.touched">
            <label for="firstName">Nombre</label>
            <input
              id="firstName"
              type="text"
              placeholder="Juan"
              formControlName="firstName"
              autocomplete="given-name"
            />
            <p class="field-error" *ngIf="firstNameControl?.invalid && firstNameControl?.touched">
              Ingresa tu nombre.
            </p>
          </div>

          <div class="form-field" [class.form-field--invalid]="lastNameControl?.invalid && lastNameControl?.touched">
            <label for="lastName">Apellido</label>
            <input
              id="lastName"
              type="text"
              placeholder="Pérez"
              formControlName="lastName"
              autocomplete="family-name"
            />
            <p class="field-error" *ngIf="lastNameControl?.invalid && lastNameControl?.touched">
              Ingresa tu apellido.
            </p>
          </div>
        </div>

        <div class="form-field" [class.form-field--invalid]="emailControl?.invalid && emailControl?.touched">
          <label for="email">Correo Corporativo</label>
          <div class="input-wrapper">
            <span class="input-icon" aria-hidden="true">
              <svg viewBox="0 0 20 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z" />
                <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z" />
              </svg>
            </span>
            <input
              id="email"
              type="email"
              placeholder="nombre@empresa.com"
              formControlName="email"
              autocomplete="email"
            />
          </div>
          <p class="field-error" *ngIf="emailControl?.invalid && emailControl?.touched">
            Ingresa un correo válido.
          </p>
        </div>

        <div class="form-field" [class.form-field--invalid]="passwordControl?.invalid && passwordControl?.touched">
          <label for="password">Contraseña</label>
          <div class="input-wrapper">
            <span class="input-icon" aria-hidden="true">
              <svg viewBox="0 0 20 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" />
              </svg>
            </span>
            <input
              id="password"
              type="password"
              placeholder="Crear contraseña"
              formControlName="password"
              autocomplete="new-password"
            />
          </div>
          <p class="field-error" *ngIf="passwordControl?.invalid && passwordControl?.touched">
            La contraseña debe tener al menos 8 caracteres.
          </p>
        </div>

        <div
          class="form-field"
          [class.form-field--invalid]="(confirmPasswordControl?.invalid && confirmPasswordControl?.touched) || passwordMismatch"
        >
          <label for="confirmPassword">Confirmar Contraseña</label>
          <div class="input-wrapper">
            <span class="input-icon" aria-hidden="true">
              <svg viewBox="0 0 20 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" />
              </svg>
            </span>
            <input
              id="confirmPassword"
              type="password"
              placeholder="Repetir contraseña"
              formControlName="confirmPassword"
              autocomplete="new-password"
            />
          </div>
          <p class="field-error" *ngIf="confirmPasswordControl?.invalid && confirmPasswordControl?.touched">
            Confirma tu contraseña.
          </p>
          <p class="field-error" *ngIf="passwordMismatch">
            Las contraseñas no coinciden.
          </p>
        </div>

        <label class="terms-checkbox" [class.terms-checkbox--invalid]="termsControl?.invalid && termsControl?.touched">
          <input type="checkbox" formControlName="terms" />
          <span class="checkbox-box">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7" />
            </svg>
          </span>
          <span class="checkbox-label">
            Acepto los
            <a href="#" class="link">Términos y Condiciones</a>
          </span>
        </label>

        <p class="field-error terms-error" *ngIf="termsControl?.invalid && termsControl?.touched">
          Debes aceptar los términos para continuar.
        </p>

        <button class="primary-button" type="submit" [disabled]="registerForm.invalid || passwordMismatch || isSubmitting">
          {{ isSubmitting ? 'Creando cuenta...' : 'Registrarse' }}
        </button>
      </form>

      <p class="card-footer">
        ¿Ya tienes una cuenta?
        <a class="link" routerLink="/auth/login">Iniciar Sesión</a>
      </p>
    </div>

    <footer class="register-footer">
      © 2024 Vigía.AI. Seguridad e Inteligencia en Obra.
    </footer>
  </div>
</section>
